<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Phiếu đồng ý tiêm chủng</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/assets/css/parent/confirm-vaccination-consent.css}">
</head>
<body style="background-color: #fff0f5;">
<div class="container mt-5">
    <div class="card shadow p-4">
        <h2 class="text-center text-uppercase mb-4 text-pink">
            Phiếu xác nhận tiêm chủng của học sinh
            <span th:text="${vaccinationConsent.student.fullName}"></span>
        </h2>

        <!-- Thông báo lỗi -->
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

        <!-- Trạng thái -->
        <div class="mb-3">
            <span th:switch="${vaccinationConsent.status.name()}">
                <span th:case="'ACCEPTED'" class="badge rounded-pill bg-success px-3 py-2">Đã đồng ý</span>
                <span th:case="'DECLINED'" class="badge rounded-pill bg-danger px-3 py-2">Đã từ chối</span>
                <span th:case="'OVERDUE'" class="badge rounded-pill bg-secondary px-3 py-2">Đã hết hạn</span>
                <span th:case="*" class="badge rounded-pill bg-warning text-dark px-3 py-2">Chưa xác nhận</span>
            </span>
        </div>

        <div th:object="${vaccinationConsent}" class="mb-4">
            <p><strong>Ngày tiêm:</strong>
                <span th:text="*{#temporals.format(schedule.injectionDate, 'dd/MM/yyyy')}"></span></p>

            <p><strong>Loại vaccine:</strong>
                <span th:text="*{schedule.vaccineType}"></span></p>

            <p><strong>Độ tuổi khuyến nghị:</strong>
                <span th:text="*{schedule.recommendedAgeMonths}"></span> tháng</p>

            <p><strong>Ghi chú:</strong>
                <span th:text="*{schedule.notes} ?: 'Không có ghi chú.'"></span></p>
        </div>

        <!-- Form xác nhận -->
        <form th:action="@{/parent/confirm/confirm-vaccination}" method="post">
            <input type="hidden" name="vaccinatonConsentId" th:value="${vaccinationConsent.id}" />

            <p class="mb-3 confirm-question">Bạn có đồng ý cho con em tham gia tiêm chủng không?</p>

            <div class="d-flex gap-3">
                <!-- Đồng ý -->
                <button type="submit"
                        name="response"
                        value="agree"
                        th:classappend="${vaccinationConsent.status.name() != 'UNCONFIRMED'} ? ' disabled'"
                        th:disabled="${vaccinationConsent.status.name() != 'UNCONFIRMED'}"
                        class="btn btn-pink">
                    Đồng ý
                </button>

                <!-- Không đồng ý -->
                <button type="submit"
                        name="response"
                        value="disagree"
                        th:classappend="${vaccinationConsent.status.name() != 'UNCONFIRMED'} ? ' disabled'"
                        th:disabled="${vaccinationConsent.status.name() != 'UNCONFIRMED'}"
                        class="btn btn-outline-danger">
                    Không đồng ý
                </button>
            </div>
        </form>
    </div>
</div>

<script th:src="@{/assets/js/parent/confirm-vaccination-consent.js}"></script>
</body>
</html>
